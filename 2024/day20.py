# inp = """#############################################################################################################################################
# #...#.............#...#...#...#...###...#.........#...............#.....#.........#...#.............#...#...###.........................#...#
# #.#.#.###########.#.#.#.#.#.#.#.#.###.#.#.#######.#.#############.#.###.#.#######.#.#.#.###########.#.#.#.#.###.#######################.#.#.#
# #.#.#.....#.....#...#...#.#.#.#.#.#...#.#.......#.#.#...#.........#.#...#.......#.#.#.#.#.....#.....#.#...#.#...#.......................#.#.#
# #.#.#####.#.###.#########.#.#.#.#.#.###.#######.#.#.#.#.#.#########.#.#########.#.#.#.#.#.###.#.#####.#####.#.###.#######################.#.#
# #.#.#...#...###.....#...#...#.#.#...#...#.......#.#...#.#.#.........#...#...#...#.#.#...#...#.#.#...#...#...#.#...#...#.....#.............#.#
# #.#.#.#.###########.#.#.#####.#.#####.###.#######.#####.#.#.###########.#.#.#.###.#.#######.#.#.#.#.###.#.###.#.###.#.#.###.#.#############.#
# #.#...#.#...#.......#.#.#...#.#...#...###.......#.###...#...#...#.......#.#.#...#.#...#.....#...#.#.#...#.....#.....#...#...#.#.......#.....#
# #.#####.#.#.#.#######.#.#.#.#.###.#.###########.#.###.#######.#.#.#######.#.###.#.###.#.#########.#.#.###################.###.#.#####.#.#####
# #.#...#...#.#.........#...#.#.#...#...#...#.....#...#...#.....#.#.#.....#.#...#.#.#...#...#...#...#.#...#...#...#.........###.#.#...#...#...#
# #.#.#.#####.###############.#.#.#####.#.#.#.#######.###.#.#####.#.#.###.#.###.#.#.#.#####.#.#.#.###.###.#.#.#.#.#.###########.#.#.#.#####.#.#
# #...#.#.....#.......#...#...#.#...#...#.#.#...#...#.#...#.#...#...#.#...#...#.#.#...#.....#.#.#.#...###.#.#...#...#...###...#.#...#.......#.#
# #####.#.#####.#####.#.#.#.###.###.#.###.#.###.#.#.#.#.###.#.#.#####.#.#####.#.#.#####.#####.#.#.#.#####.#.#########.#.###.#.#.#############.#
# ###...#...###.....#.#.#.#...#.#...#.###.#.###...#.#.#...#...#...#...#.....#.#.#...#...#...#.#.#.#.#.....#...#...#...#...#.#...#.............#
# ###.#####.#######.#.#.#.###.#.#.###.###.#.#######.#.###.#######.#.#######.#.#.###.#.###.#.#.#.#.#.#.#######.#.#.#.#####.#.#####.#############
# #...#...#...###...#.#.#.###.#.#...#.#...#...###...#.###.......#.#...#.....#.#...#.#.....#.#.#...#.#.#.....#...#.#.#.....#.#.....#...#.......#
# #.###.#.###.###.###.#.#.###.#.###.#.#.#####.###.###.#########.#.###.#.#####.###.#.#######.#.#####.#.#.###.#####.#.#.#####.#.#####.#.#.#####.#
# #...#.#...#...#...#.#.#.#...#...#.#.#.....#...#...#...#.....#.#.#...#...###...#.#...#.....#.....#.#.#...#.......#.#.#.....#...###.#.#.#.....#
# ###.#.###.###.###.#.#.#.#.#####.#.#.#####.###.###.###.#.###.#.#.#.#####.#####.#.###.#.#########.#.#.###.#########.#.#.#######.###.#.#.#.#####
# ###...###...#.....#...#.#.#.....#.#...#...#...#...#...#...#...#.#.#.....#...#.#...#.#.....#...#.#.#...#...........#.#...#.....#...#...#...###
# ###########.###########.#.#.#####.###.#.###.###.###.#####.#####.#.#.#####.#.#.###.#.#####.#.#.#.#.###.#############.###.#.#####.#########.###
# #.......###...........#...#.#...#...#.#...#...#...#.....#.....#.#.#.....#.#.#...#.#.#.....#.#.#.#.#...#.............#...#.#...#...#.....#...#
# #.#####.#############.#####.#.#.###.#.###.###.###.#####.#####.#.#.#####.#.#.###.#.#.#.#####.#.#.#.#.###.#############.###.#.#.###.#.###.###.#
# #.....#...........###...#...#.#...#.#.....#...###.#.....#...#.#...#.....#.#...#.#.#.#.###...#...#...#...#...#.......#...#...#.#...#...#.....#
# #####.###########.#####.#.###.###.#.#######.#####.#.#####.#.#.#####.#####.###.#.#.#.#.###.###########.###.#.#.#####.###.#####.#.#####.#######
# #...#...........#.#...#.#.###...#.#.#.....#.#...#.#.###...#.#.....#.....#...#.#.#...#.#...#...........#...#...#...#.#...#...#...#...#.......#
# #.#.###########.#.#.#.#.#.#####.#.#.#.###.#.#.#.#.#.###.###.#####.#####.###.#.#.#####.#.###.###########.#######.#.#.#.###.#.#####.#.#######.#
# #.#.............#...#...#...###.#.#...#...#.#.#.#.#...#.#...#...#.#.....###.#.#.#.....#.#...#...###.....#.......#...#...#.#.......#...#.....#
# #.#########################.###.#.#####.###.#.#.#.###.#.#.###.#.#.#.#######.#.#.#.#####.#.###.#.###.#####.#############.#.###########.#.#####
# #.#...................#...#.....#.#...#.#...#.#.#.#...#.#.###.#.#.#.....#...#.#.#.#...#.#.###.#.....#...#.........###...#...........#...#...#
# #.#.#################.#.#.#######.#.#.#.#.###.#.#.#.###.#.###.#.#.#####.#.###.#.#.#.#.#.#.###.#######.#.#########.###.#############.#####.#.#
# #...#.................#.#...#...#...#...#...#.#...#...#.#...#.#.#.#...#.#...#.#.#.#.#.#.#.#...#.......#...........#...#...#...#...#.....#.#.#
# #####.#################.###.#.#.###########.#.#######.#.###.#.#.#.#.#.#.###.#.#.#.#.#.#.#.#.###.###################.###.#.#.#.#.#.#####.#.#.#
# #...#...#.....#...#.....###...#.........#...#.#.......#.#...#.#.#.#.#...###.#.#.#.#.#.#.#.#...#.#...#...###...###...#...#...#...#.......#.#.#
# #.#.###.#.###.#.#.#.###################.#.###.#.#######.#.###.#.#.#.#######.#.#.#.#.#.#.#.###.#.#.#.#.#.###.#.###.###.###################.#.#
# #.#.....#.###.#.#...#...........###...#.#.#...#.....#...#.#...#.#.#.#...#...#.#.#.#.#.#.#...#.#.#.#.#.#...#.#.#...#...#...#...#...###...#.#.#
# #.#######.###.#.#####.#########.###.#.#.#.#.#######.#.###.#.###.#.#.#.#.#.###.#.#.#.#.#.###.#.#.#.#.#.###.#.#.#.###.###.#.#.#.#.#.###.#.#.#.#
# #...#.....#...#.#.....#...#...#...#.#.#.#.#.......#.#...#.#.#...#.#.#.#.#.#...#.#...#.#.#...#.#.#.#.#.###...#.#...#...#.#.#.#.#.#.#...#...#.#
# ###.#.#####.###.#.#####.#.#.#.###.#.#.#.#.#######.#.###.#.#.#.###.#.#.#.#.#.###.#####.#.#.###.#.#.#.#.#######.###.###.#.#.#.#.#.#.#.#######.#
# #...#.#.....#...#.......#...#...#...#.#.#.#...#...#.#...#...#...#.#.#.#.#.#...#...###.#.#.#...#...#.#.#.......###.#...#.#.#.#.#.#.#.#.......#
# #.###.#.#####.#################.#####.#.#.#.#.#.###.#.#########.#.#.#.#.#.###.###.###.#.#.#.#######.#.#.#########.#.###.#.#.#.#.#.#.#.#######
# #.#...#.#.....#.......#.........#...#...#.#.#...#...#.........#...#...#.#.###...#...#...#...#...###...#...#.......#...#.#.#.#...#...#...#...#
# #.#.###.#.#####.#####.#.#########.#.#####.#.#####.###########.#########.#.#####.###.#########.#.#########.#.#########.#.#.#.###########.#.#.#
# #.#...#...#.....#...#...#.........#...#...#...#...#.....#.....#.......#.#.....#...#...#.......#.........#...#...#...#...#...#...#...#...#.#.#
# #.###.#####.#####.#.#####.###########.#.#####.#.###.###.#.#####.#####.#.#####.###.###.#.###############.#####.#.#.#.#########.#.#.#.#.###.#.#
# #...#.#...#.......#.......###.........#.#.....#...#...#.#.......#.....#.......###.....#.......#...#.....#.....#...#.#.........#...#...###.#.#
# ###.#.#.#.###################.#########.#.#######.###.#.#########.###########################.#.#.#.#####.#########.#.###################.#.#
# ###...#.#.............#.......#.....###.#.......#...#.#...#.....#.....#...###...###...........#.#.#.....#.........#...#.....#.............#.#
# #######.#############.#.#######.###.###.#######.###.#.###.#.###.#####.#.#.###.#.###.###########.#.#####.#########.#####.###.#.#############.#
# #...###.............#.#.....#...###...#.#.......###.#...#.#.#...#...#...#.....#...#...#.....#...#.....#.#.........#...#.#...#.#.......#...#.#
# #.#.###############.#.#####.#.#######.#.#.#########.###.#.#.#.###.#.#############.###.#.###.#.#######.#.#.#########.#.#.#.###.#.#####.#.#.#.#
# #.#...#.............#.....#...###.....#.#.........#.#...#...#...#.#.#.....#...#...###...#...#.#.......#...#.........#...#.....#.....#.#.#.#.#
# #.###.#.#################.#######.#####.#########.#.#.#########.#.#.#.###.#.#.#.#########.###.#.###########.#######################.#.#.#.#.#
# #...#.#.........#...#...#.......#...###...#...#...#.#.........#.#.#.#...#...#.#...#.......#...#.............#.........#...#.........#...#...#
# ###.#.#########.#.#.#.#.#######.###.#####.#.#.#.###.#########.#.#.#.###.#####.###.#.#######.#################.#######.#.#.#.#################
# #...#.......###...#...#.......#.#...#...#...#...###...#...#...#.#.#...#.....#.#...#.......#.#.................###...#...#.#.......#...#.....#
# #.#########.#################.#.#.###.#.#############.#.#.#.###.#.###.#####.#.#.#########.#.#.###################.#.#####.#######.#.#.#.###.#
# #.#...#...#...###.............#.#.....#.........#...#.#.#...#...#...#.#...#.#.#.....#.....#.#.................#...#.#...#...#...#...#...#...#
# #.#.#.#.#.###.###.#############.###############.#.#.#.#.#####.#####.#.#.#.#.#.#####.#.#####.#################.#.###.#.#.###.#.#.#########.###
# #...#...#...#.....#...........#.#...............#.#.#...#...#.....#.#.#.#.#.#.#.....#...#...#.................#.#...#.#...#...#...........###
# ###########.#######.#########.#.#.###############.#.#####.#.#####.#.#.#.#.#.#.#.#######.#.###.#################.#.###.###.###################
# #.........#.........#.........#.#.............#...#...#...#.....#...#...#...#...###.....#.###.....#...........#.#...#.#...###.....#.........#
# #.#######.###########.#########.#############.#.#####.#.#######.###################.#####.#######.#.#########.#.###.#.#.#####.###.#.#######.#
# #.......#.............#...#...#...........#...#...#...#.#.......#...........#.....#.......#...###...#.......#...#...#.#.#...#.#...#...#.....#
# #######.###############.#.#.#.###########.#.#####.#.###.#.#######.#########.#.###.#########.#.#######.#####.#####.###.#.#.#.#.#.#####.#.#####
# #...###...........#.....#...#.#.........#.#.......#.....#.........#.....#...#...#.###...#...#.........#...#.....#.....#...#...#.......#...###
# #.#.#############.#.#########.#.#######.#.#########################.###.#.#####.#.###.#.#.#############.#.#####.#########################.###
# #.#.........#...#.#.#.........#.#.......#.#...#.....#...#.....#...#.###...#.....#.....#.#...............#.....#.#.....#...#...#.....#...#...#
# #.#########.#.#.#.#.#.#########.#.#######.#.#.#.###.#.#.#.###.#.#.#.#######.###########.#####################.#.#.###.#.#.#.#.#.###.#.#.###.#
# #.........#.#.#.#...#.........#.#.......#...#.#.###.#.#.#...#.#.#.#.#...###...#...#...#.#.....................#...###...#...#.#...#...#.#...#
# #########.#.#.#.#############.#.#######.#####.#.###.#.#.###.#.#.#.#.#.#.#####.#.#.#.#.#.#.###################################.###.#####.#.###
# #.....#...#.#.#.###...#...###...#.......#...#.#...#.#.#.....#...#...#.#.....#...#...#.#.#.#.................#.....#...#...###.#...#...#.#...#
# #.###.#.###.#.#.###.#.#.#.#######.#######.#.#.###.#.#.###############.#####.#########.#.#.#.###############.#.###.#.#.#.#.###.#.###.#.#.###.#
# #...#.#...#.#.#...#.#...#.#.....#.........#.#.#...#.#.....#...#...###.#.....###.......#.#...#...#...#...#...#.#...#.#.#.#...#.#.###.#.#.....#
# ###.#.###.#.#.###.#.#####.#.###.###########.#.#.###.#####.#.#.#.#.###.#.#######.#######.#####.#.#.#.#.#.#.###.#.###.#.#.###.#.#.###.#.#######
# ###.#.#...#...#...#.....#...#...###...#...#.#.#.###.#...#...#...#.#...#...#...#.......#...#...#...#...#.#...#.#.....#.#.#...#.#...#.#...#...#
# ###.#.#.#######.#######.#####.#####.#.#.#.#.#.#.###.#.#.#########.#.#####.#.#.#######.###.#.###########.###.#.#######.#.#.###.###.#.###.#.#.#
# #...#...#.....#...#.....#...#...#...#...#.#.#.#...#.#.#.#...#.....#...#...#.#.###...#...#.#...........#.....#.#.......#.#...#.#...#.#...#.#.#
# #.#######.###.###.#.#####.#.###.#.#######.#.#.###.#.#.#.#.#.#.#######.#.###.#.###.#.###.#.###########.#######.#.#######.###.#.#.###.#.###.#.#
# #...#...#.###...#...#.....#...#.#.......#...#.....#...#.#.#...###.....#...#.#.#...#.....#.....#...#...#...###.#.........#...#...###.#.....#.#
# ###.#.#.#.#####.#####.#######.#.#######.###############.#.#######.#######.#.#.#.#############.#.#.#.###.#.###.###########.#########.#######.#
# #...#.#.#...###.......#.......#.......#...###...#.....#...###...#.#.....#...#.#.......#.....#...#...#...#.....#.....#...#.#...###...#...#...#
# #.###.#.###.###########.#############.###.###.#.#.###.#######.#.#.#.###.#####.#######.#.###.#########.#########.###.#.#.#.#.#.###.###.#.#.###
# #...#.#.#...#...#.....#...#...#.....#.....#...#...#...#.......#.#...#...#...#.........#.###.#...#...#.#.........###.#.#.#...#.....#...#...###
# ###.#.#.#.###.#.#.###.###.#.#.#.###.#######.#######.###.#######.#####.###.#.###########.###.#.#.#.#.#.#.###########.#.#.###########.#########
# #...#.#.#...#.#.#...#.....#.#...###.........#...#...#...#...#...#...#...#.#.#...#...#...#...#.#...#.#.#...........#...#.#.....#...#.....#...#
# #.###.#.###.#.#.###.#######.#################.#.#.###.###.#.#.###.#.###.#.#.#.#.#.#.#.###.###.#####.#.###########.#####.#.###.#.#.#####.#.#.#
# #...#.#...#.#.#...#.........#...###...........#...###.#...#...###.#...#...#...#.#.#...#...#...#.....#.#.......#...#...#...###...#.......#.#.#
# ###.#.###.#.#.###.###########.#.###.#################.#.#########.###.#########.#.#####.###.###.#####.#.#####.#.###.#.###################.#.#
# ###.#.#...#.#...#...#.........#...#.......#...........#.#...#...#.#...###...###...#.....#...#...#.....#.....#.#.....#...#...............#.#.#
# ###.#.#.###.###.###.#.###########.#######.#.###########.#.#.#.#.#.#.#####.#.#######.#####.###.###.#########.#.#########.#.#############.#.#.#
# #...#.#.....###...#...#.....#...#.........#.#.....#...#.#.#.#.#.#.#...#...#.......#.....#...#.....#.........#.........#...#.....#...#...#.#.#
# #.###.###########.#####.###.#.#.###########.#.###.#.#.#.#.#.#.#.#.###.#.#########.#####.###.#######.#################.#####.###.#.#.#.###.#.#
# #...#.#...........#...#.###...#.............#...#...#...#.#.#.#.#.#...#.....#.....#...#.....###...#...............###...#...###...#...#...#.#
# ###.#.#.###########.#.#.#######################.#########.#.#.#.#.#.#######.#.#####.#.#########.#.###############.#####.#.#############.###.#
# #...#.#.............#...#...#.........#.........#######...#...#.#.#...#...#.#.....#.#.#...###...#.................#...#...#.............#...#
# #.###.###################.#.#.#######.#.###############.#######.#.###.#.#.#.#####.#.#.#.#.###.#####################.#.#####.#############.###
# #.....#...................#...#.....#.#...###########...#.......#...#...#.#...#...#.#...#.#...#.....................#.......#.............###
# #######.#######################.###.#.###.###########.###.#########.#####.###.#.###.#####.#.###.#############################.###############
# ###...#...........#.............#...#.....###########...#.#.......#.#.....###.#.###.....#.#.....#.......#...................#...........#...#
# ###.#.###########.#.#############.#####################.#.#.#####.#.#.#######.#.#######.#.#######.#####.#.#################.###########.#.#.#
# #...#...........#.#.###...###...#.......#############...#.#.....#.#.#.#...#...#.#...#...#...#...#.....#...#...#...........#.#...#.......#.#.#
# #.#############.#.#.###.#.###.#.#######.#############.###.#####.#.#.#.#.#.#.###.#.#.#.#####.#.#.#####.#####.#.#.#########.#.#.#.#.#######.#.#
# #.....#.......#.#...#...#.....#.........#############...#.#...#.#.#.#.#.#.#...#.#.#.#...#...#.#.#...#.....#.#...#.....#...#.#.#.#.....#...#.#
# #####.#.#####.#.#####.#################################.#.#.#.#.#.#.#.#.#.###.#.#.#.###.#.###.#.#.#.#####.#.#####.###.#.###.#.#.#####.#.###.#
# #.....#.#.....#...#...#...#...#...#S#################...#.#.#.#.#.#.#...#.#...#.#.#...#.#...#.#.#.#.#...#...#.....#...#.###...#.#...#...#...#
# #.#####.#.#######.#.###.#.#.#.#.#.#.#################.###.#.#.#.#.#.#####.#.###.#.###.#.###.#.#.#.#.#.#.#####.#####.###.#######.#.#.#####.###
# #.......#.......#...#...#...#.#.#.#.#################...#.#.#.#.#.#...#...#...#.#...#.#.#...#.#.#.#.#.#.#...#...###...#...#...#...#.....#...#
# ###############.#####.#######.#.#.#.###################.#.#.#.#.#.###.#.#####.#.###.#.#.#.###.#.#.#.#.#.#.#.###.#####.###.#.#.#########.###.#
# #.............#.....#.#.......#.#...#################...#...#.#.#...#.#...#...#...#.#...#...#.#.#.#.#.#.#.#...#.....#...#...#.........#.....#
# #.###########.#####.#.#.#######.#####################.#######.#.###.#.###.#.#####.#.#######.#.#.#.#.#.#.#.###.#####.###.#############.#######
# #...........#.......#.#.....#...#...#################...###...#.#...#...#.#.....#.#.###.....#.#.#.#...#.#...#.#...#...#...#.....#...#...#...#
# ###########.#########.#####.#.###.#.###################.###.###.#.#####.#.#####.#.#.###.#####.#.#.#####.###.#.#.#.###.###.#.###.#.#.###.#.#.#
# #...........#...#...#.....#.#.....#.###################...#.#...#...#...#.#.....#.#...#.....#.#.#.#.....#...#.#.#...#...#.#...#...#...#...#.#
# #.###########.#.#.#.#####.#.#######.#####################.#.#.#####.#.###.#.#####.###.#####.#.#.#.#.#####.###.#.###.###.#.###.#######.#####.#
# #...#...#...#.#...#...#...#.#...#...###################...#.#...#...#.#...#...###...#.#.....#.#.#.#...#...#...#...#.#...#.....#.....#...#...#
# ###.#.#.#.#.#.#######.#.###.#.#.#.#####################.###.###.#.###.#.#####.#####.#.#.#####.#.#.###.#.###.#####.#.#.#########.###.###.#.###
# ###...#...#...###...#.#.###...#.#...#################...###.#...#...#.#.#...#...###.#.#.....#.#.#...#.#.###...#...#.#.........#.#...#...#...#
# #################.#.#.#.#######.###.#################.#####.#.#####.#.#.#.#.###.###.#.#####.#.#.###.#.#.#####.#.###.#########.#.#.###.#####.#
# #...............#.#...#.....###.#...#############E..#.....#...#.....#.#.#.#.#...#...#...#...#.#.#...#.#.....#.#...#...#.....#...#.###.......#
# #.#############.#.#########.###.#.#################.#####.#####.#####.#.#.#.#.###.#####.#.###.#.#.###.#####.#.###.###.#.###.#####.###########
# #.....#...#...#...#.....#...#...#...#...............#...#.....#.#...#.#.#.#...###...#...#...#.#.#.#...#...#.#...#...#.#...#.#...#...........#
# #####.#.#.#.#.#####.###.#.###.#####.#.###############.#.#####.#.#.#.#.#.#.#########.#.#####.#.#.#.#.###.#.#.###.###.#.###.#.#.#.###########.#
# #...#.#.#...#.....#...#.#...#...#...#.............#...#...#...#...#.#.#.#.#.........#.#...#...#...#.#...#...#...#...#.#...#...#.#...#...#...#
# #.#.#.#.#########.###.#.###.###.#.###############.#.#####.#.#######.#.#.#.#.#########.#.#.#########.#.#######.###.###.#.#######.#.#.#.#.#.###
# #.#...#.#.......#.#...#...#...#.#.###.............#.....#...#.....#.#.#.#.#.#...#...#...#...#...#...#.......#...#.#...#.#.....#.#.#.#.#.#...#
# #.#####.#.#####.#.#.#####.###.#.#.###.#################.#####.###.#.#.#.#.#.#.#.#.#.#######.#.#.#.#########.###.#.#.###.#.###.#.#.#.#.#.###.#
# #.#...#.#.....#...#.....#.#...#.#...#.............#...#.......#...#.#.#.#.#...#.#.#...#...#...#.#...........#...#.#...#...#...#...#...#.....#
# #.#.#.#.#####.#########.#.#.###.###.#############.#.#.#########.###.#.#.#.#####.#.###.#.#.#####.#############.###.###.#####.#################
# #.#.#.#.#.....#...#...#.#.#...#.#...#.............#.#.#.....#...###...#...#.....#.###...#.#...#.............#...#.#...#...#.............#...#
# #.#.#.#.#.#####.#.#.#.#.#.###.#.#.###.#############.#.#.###.#.#############.#####.#######.#.#.#############.###.#.#.###.#.#############.#.#.#
# #.#.#.#.#.....#.#.#.#.#.#.....#...###...........#...#.#.###.#...........###...#...#.......#.#...#...#.......###...#...#.#.#.............#.#.#
# #.#.#.#.#####.#.#.#.#.#.#######################.#.###.#.###.###########.#####.#.###.#######.###.#.#.#.###############.#.#.#.#############.#.#
# #...#.#...#...#.#.#.#...###.......#...#...#.....#...#.#...#.......#...#...###...###.#.....#.#...#.#.#.........#.......#.#.#.......#...#...#.#
# #####.###.#.###.#.#.#######.#####.#.#.#.#.#.#######.#.###.#######.#.#.###.#########.#.###.#.#.###.#.#########.#.#######.#.#######.#.#.#.###.#
# #.....#...#...#.#.#.......#.....#.#.#.#.#...#.....#.#...#.#...###...#.#...#.........#.###...#...#.#...#.......#.#.....#.#...#...#...#...#...#
# #.#####.#####.#.#.#######.#####.#.#.#.#.#####.###.#.###.#.#.#.#######.#.###.#########.#########.#.###.#.#######.#.###.#.###.#.#.#########.###
# #.#...#...#...#.#...#...#.#.....#...#...#...#.#...#.#...#...#.......#.#.#...#...#...#.#.........#.#...#.....#...#.#...#...#.#.#.#...#...#...#
# #.#.#.###.#.###.###.#.#.#.#.#############.#.#.#.###.#.#############.#.#.#.###.#.#.#.#.#.#########.#.#######.#.###.#.#####.#.#.#.#.#.#.#.###.#
# #...#.....#.....###...#...#...............#...#.....#...............#...#.....#...#...#...........#.........#.....#.......#...#...#...#.....#
# #############################################################################################################################################"""
# # inp = """###############
# # #...#...#.....#
# # #.#.#.#.#.###.#
# # #S#...#.#.#...#
# # #######.#.#.###
# # #######.#.#...#
# # #######.#.###.#
# # ###..E#...#...#
# # ###.#######.###
# # #...###...#...#
# # #.#####.#.###.#
# # #.#...#.#.#...#
# # #.#.#.#.#.#.###
# # #...#...#...###
# # ###############"""

# from collections import deque, defaultdict
# from tqdm import tqdm


# inp = [list(x) for x in inp.split("\n")]

# start, end = None, None

# for i in range(len(inp)):
#     for j in range(len(inp[i])):
#         if inp[i][j] == "S":
#             start = (i, j)
#             inp[i][j] = "."
#         if inp[i][j] == "E":
#             end = (i, j)
#             inp[i][j] = "."

# cheats = set()
# # find all places that can be cheated
# for i in range(len(inp)):  # row
#     for j in range(len(inp[i])):  # col
#         if inp[i][j] == "#":
#             try:
#                 if inp[i - 1][j] == "." and inp[i + 1][j] == ".":
#                     cheats.add((i, j))
#                 elif inp[i][j - 1] == "." and inp[i][j + 1] == ".":
#                     cheats.add((i, j))
#             except:
#                 pass

# # for i in range(len(inp)):  # row
# #     for j in range(len(inp[i])):  # col
# #         if (i, j) in cheats:
# #             inp[i][j] = "$"

# # for i in inp:
# #     print(*i, sep="")


# def shortest_path(start, end):

#     q = deque()
#     q.append(start)
#     visited = set()
#     visited.add(start)

#     dirs = [(1, 0), (-1, 0), (0, 1), (0, -1)]
#     length = 0
#     while q:

#         for i in range(len(q)):
#             r, c = q.popleft()
#             if (r, c) == end:
#                 return length
#             for dr, dc in dirs:
#                 nr = r + dr
#                 nc = c + dc

#                 if (
#                     not (0 <= nr < len(inp))
#                     or not (0 <= nc < len(inp[0]))
#                     or inp[nr][nc] == "#"
#                     or (nr, nc) in visited
#                 ):
#                     continue
#                 q.append((nr, nc))
#                 visited.add((nr, nc))
#         length += 1


# longest = shortest_path(start, end)
# saves = defaultdict(int)
# for r, c in tqdm(cheats):
#     inp[r][c] = "."
#     saved = longest - shortest_path(start, end)
#     saves[saved] += 1
#     inp[r][c] = "#"
# print(saves)

# part1 = 0
# for i in saves:
#     if i >= 100:
#         part1 += saves[i]
# print(part1)


import numpy as np
from tqdm import tqdm

lines = """#############################################################################################################################################
#...#.............#...#...#...#...###...#.........#...............#.....#.........#...#.............#...#...###.........................#...#
#.#.#.###########.#.#.#.#.#.#.#.#.###.#.#.#######.#.#############.#.###.#.#######.#.#.#.###########.#.#.#.#.###.#######################.#.#.#
#.#.#.....#.....#...#...#.#.#.#.#.#...#.#.......#.#.#...#.........#.#...#.......#.#.#.#.#.....#.....#.#...#.#...#.......................#.#.#
#.#.#####.#.###.#########.#.#.#.#.#.###.#######.#.#.#.#.#.#########.#.#########.#.#.#.#.#.###.#.#####.#####.#.###.#######################.#.#
#.#.#...#...###.....#...#...#.#.#...#...#.......#.#...#.#.#.........#...#...#...#.#.#...#...#.#.#...#...#...#.#...#...#.....#.............#.#
#.#.#.#.###########.#.#.#####.#.#####.###.#######.#####.#.#.###########.#.#.#.###.#.#######.#.#.#.#.###.#.###.#.###.#.#.###.#.#############.#
#.#...#.#...#.......#.#.#...#.#...#...###.......#.###...#...#...#.......#.#.#...#.#...#.....#...#.#.#...#.....#.....#...#...#.#.......#.....#
#.#####.#.#.#.#######.#.#.#.#.###.#.###########.#.###.#######.#.#.#######.#.###.#.###.#.#########.#.#.###################.###.#.#####.#.#####
#.#...#...#.#.........#...#.#.#...#...#...#.....#...#...#.....#.#.#.....#.#...#.#.#...#...#...#...#.#...#...#...#.........###.#.#...#...#...#
#.#.#.#####.###############.#.#.#####.#.#.#.#######.###.#.#####.#.#.###.#.###.#.#.#.#####.#.#.#.###.###.#.#.#.#.#.###########.#.#.#.#####.#.#
#...#.#.....#.......#...#...#.#...#...#.#.#...#...#.#...#.#...#...#.#...#...#.#.#...#.....#.#.#.#...###.#.#...#...#...###...#.#...#.......#.#
#####.#.#####.#####.#.#.#.###.###.#.###.#.###.#.#.#.#.###.#.#.#####.#.#####.#.#.#####.#####.#.#.#.#####.#.#########.#.###.#.#.#############.#
###...#...###.....#.#.#.#...#.#...#.###.#.###...#.#.#...#...#...#...#.....#.#.#...#...#...#.#.#.#.#.....#...#...#...#...#.#...#.............#
###.#####.#######.#.#.#.###.#.#.###.###.#.#######.#.###.#######.#.#######.#.#.###.#.###.#.#.#.#.#.#.#######.#.#.#.#####.#.#####.#############
#...#...#...###...#.#.#.###.#.#...#.#...#...###...#.###.......#.#...#.....#.#...#.#.....#.#.#...#.#.#.....#...#.#.#.....#.#.....#...#.......#
#.###.#.###.###.###.#.#.###.#.###.#.#.#####.###.###.#########.#.###.#.#####.###.#.#######.#.#####.#.#.###.#####.#.#.#####.#.#####.#.#.#####.#
#...#.#...#...#...#.#.#.#...#...#.#.#.....#...#...#...#.....#.#.#...#...###...#.#...#.....#.....#.#.#...#.......#.#.#.....#...###.#.#.#.....#
###.#.###.###.###.#.#.#.#.#####.#.#.#####.###.###.###.#.###.#.#.#.#####.#####.#.###.#.#########.#.#.###.#########.#.#.#######.###.#.#.#.#####
###...###...#.....#...#.#.#.....#.#...#...#...#...#...#...#...#.#.#.....#...#.#...#.#.....#...#.#.#...#...........#.#...#.....#...#...#...###
###########.###########.#.#.#####.###.#.###.###.###.#####.#####.#.#.#####.#.#.###.#.#####.#.#.#.#.###.#############.###.#.#####.#########.###
#.......###...........#...#.#...#...#.#...#...#...#.....#.....#.#.#.....#.#.#...#.#.#.....#.#.#.#.#...#.............#...#.#...#...#.....#...#
#.#####.#############.#####.#.#.###.#.###.###.###.#####.#####.#.#.#####.#.#.###.#.#.#.#####.#.#.#.#.###.#############.###.#.#.###.#.###.###.#
#.....#...........###...#...#.#...#.#.....#...###.#.....#...#.#...#.....#.#...#.#.#.#.###...#...#...#...#...#.......#...#...#.#...#...#.....#
#####.###########.#####.#.###.###.#.#######.#####.#.#####.#.#.#####.#####.###.#.#.#.#.###.###########.###.#.#.#####.###.#####.#.#####.#######
#...#...........#.#...#.#.###...#.#.#.....#.#...#.#.###...#.#.....#.....#...#.#.#...#.#...#...........#...#...#...#.#...#...#...#...#.......#
#.#.###########.#.#.#.#.#.#####.#.#.#.###.#.#.#.#.#.###.###.#####.#####.###.#.#.#####.#.###.###########.#######.#.#.#.###.#.#####.#.#######.#
#.#.............#...#...#...###.#.#...#...#.#.#.#.#...#.#...#...#.#.....###.#.#.#.....#.#...#...###.....#.......#...#...#.#.......#...#.....#
#.#########################.###.#.#####.###.#.#.#.###.#.#.###.#.#.#.#######.#.#.#.#####.#.###.#.###.#####.#############.#.###########.#.#####
#.#...................#...#.....#.#...#.#...#.#.#.#...#.#.###.#.#.#.....#...#.#.#.#...#.#.###.#.....#...#.........###...#...........#...#...#
#.#.#################.#.#.#######.#.#.#.#.###.#.#.#.###.#.###.#.#.#####.#.###.#.#.#.#.#.#.###.#######.#.#########.###.#############.#####.#.#
#...#.................#.#...#...#...#...#...#.#...#...#.#...#.#.#.#...#.#...#.#.#.#.#.#.#.#...#.......#...........#...#...#...#...#.....#.#.#
#####.#################.###.#.#.###########.#.#######.#.###.#.#.#.#.#.#.###.#.#.#.#.#.#.#.#.###.###################.###.#.#.#.#.#.#####.#.#.#
#...#...#.....#...#.....###...#.........#...#.#.......#.#...#.#.#.#.#...###.#.#.#.#.#.#.#.#...#.#...#...###...###...#...#...#...#.......#.#.#
#.#.###.#.###.#.#.#.###################.#.###.#.#######.#.###.#.#.#.#######.#.#.#.#.#.#.#.###.#.#.#.#.#.###.#.###.###.###################.#.#
#.#.....#.###.#.#...#...........###...#.#.#...#.....#...#.#...#.#.#.#...#...#.#.#.#.#.#.#...#.#.#.#.#.#...#.#.#...#...#...#...#...###...#.#.#
#.#######.###.#.#####.#########.###.#.#.#.#.#######.#.###.#.###.#.#.#.#.#.###.#.#.#.#.#.###.#.#.#.#.#.###.#.#.#.###.###.#.#.#.#.#.###.#.#.#.#
#...#.....#...#.#.....#...#...#...#.#.#.#.#.......#.#...#.#.#...#.#.#.#.#.#...#.#...#.#.#...#.#.#.#.#.###...#.#...#...#.#.#.#.#.#.#...#...#.#
###.#.#####.###.#.#####.#.#.#.###.#.#.#.#.#######.#.###.#.#.#.###.#.#.#.#.#.###.#####.#.#.###.#.#.#.#.#######.###.###.#.#.#.#.#.#.#.#######.#
#...#.#.....#...#.......#...#...#...#.#.#.#...#...#.#...#...#...#.#.#.#.#.#...#...###.#.#.#...#...#.#.#.......###.#...#.#.#.#.#.#.#.#.......#
#.###.#.#####.#################.#####.#.#.#.#.#.###.#.#########.#.#.#.#.#.###.###.###.#.#.#.#######.#.#.#########.#.###.#.#.#.#.#.#.#.#######
#.#...#.#.....#.......#.........#...#...#.#.#...#...#.........#...#...#.#.###...#...#...#...#...###...#...#.......#...#.#.#.#...#...#...#...#
#.#.###.#.#####.#####.#.#########.#.#####.#.#####.###########.#########.#.#####.###.#########.#.#########.#.#########.#.#.#.###########.#.#.#
#.#...#...#.....#...#...#.........#...#...#...#...#.....#.....#.......#.#.....#...#...#.......#.........#...#...#...#...#...#...#...#...#.#.#
#.###.#####.#####.#.#####.###########.#.#####.#.###.###.#.#####.#####.#.#####.###.###.#.###############.#####.#.#.#.#########.#.#.#.#.###.#.#
#...#.#...#.......#.......###.........#.#.....#...#...#.#.......#.....#.......###.....#.......#...#.....#.....#...#.#.........#...#...###.#.#
###.#.#.#.###################.#########.#.#######.###.#.#########.###########################.#.#.#.#####.#########.#.###################.#.#
###...#.#.............#.......#.....###.#.......#...#.#...#.....#.....#...###...###...........#.#.#.....#.........#...#.....#.............#.#
#######.#############.#.#######.###.###.#######.###.#.###.#.###.#####.#.#.###.#.###.###########.#.#####.#########.#####.###.#.#############.#
#...###.............#.#.....#...###...#.#.......###.#...#.#.#...#...#...#.....#...#...#.....#...#.....#.#.........#...#.#...#.#.......#...#.#
#.#.###############.#.#####.#.#######.#.#.#########.###.#.#.#.###.#.#############.###.#.###.#.#######.#.#.#########.#.#.#.###.#.#####.#.#.#.#
#.#...#.............#.....#...###.....#.#.........#.#...#...#...#.#.#.....#...#...###...#...#.#.......#...#.........#...#.....#.....#.#.#.#.#
#.###.#.#################.#######.#####.#########.#.#.#########.#.#.#.###.#.#.#.#########.###.#.###########.#######################.#.#.#.#.#
#...#.#.........#...#...#.......#...###...#...#...#.#.........#.#.#.#...#...#.#...#.......#...#.............#.........#...#.........#...#...#
###.#.#########.#.#.#.#.#######.###.#####.#.#.#.###.#########.#.#.#.###.#####.###.#.#######.#################.#######.#.#.#.#################
#...#.......###...#...#.......#.#...#...#...#...###...#...#...#.#.#...#.....#.#...#.......#.#.................###...#...#.#.......#...#.....#
#.#########.#################.#.#.###.#.#############.#.#.#.###.#.###.#####.#.#.#########.#.#.###################.#.#####.#######.#.#.#.###.#
#.#...#...#...###.............#.#.....#.........#...#.#.#...#...#...#.#...#.#.#.....#.....#.#.................#...#.#...#...#...#...#...#...#
#.#.#.#.#.###.###.#############.###############.#.#.#.#.#####.#####.#.#.#.#.#.#####.#.#####.#################.#.###.#.#.###.#.#.#########.###
#...#...#...#.....#...........#.#...............#.#.#...#...#.....#.#.#.#.#.#.#.....#...#...#.................#.#...#.#...#...#...........###
###########.#######.#########.#.#.###############.#.#####.#.#####.#.#.#.#.#.#.#.#######.#.###.#################.#.###.###.###################
#.........#.........#.........#.#.............#...#...#...#.....#...#...#...#...###.....#.###.....#...........#.#...#.#...###.....#.........#
#.#######.###########.#########.#############.#.#####.#.#######.###################.#####.#######.#.#########.#.###.#.#.#####.###.#.#######.#
#.......#.............#...#...#...........#...#...#...#.#.......#...........#.....#.......#...###...#.......#...#...#.#.#...#.#...#...#.....#
#######.###############.#.#.#.###########.#.#####.#.###.#.#######.#########.#.###.#########.#.#######.#####.#####.###.#.#.#.#.#.#####.#.#####
#...###...........#.....#...#.#.........#.#.......#.....#.........#.....#...#...#.###...#...#.........#...#.....#.....#...#...#.......#...###
#.#.#############.#.#########.#.#######.#.#########################.###.#.#####.#.###.#.#.#############.#.#####.#########################.###
#.#.........#...#.#.#.........#.#.......#.#...#.....#...#.....#...#.###...#.....#.....#.#...............#.....#.#.....#...#...#.....#...#...#
#.#########.#.#.#.#.#.#########.#.#######.#.#.#.###.#.#.#.###.#.#.#.#######.###########.#####################.#.#.###.#.#.#.#.#.###.#.#.###.#
#.........#.#.#.#...#.........#.#.......#...#.#.###.#.#.#...#.#.#.#.#...###...#...#...#.#.....................#...###...#...#.#...#...#.#...#
#########.#.#.#.#############.#.#######.#####.#.###.#.#.###.#.#.#.#.#.#.#####.#.#.#.#.#.#.###################################.###.#####.#.###
#.....#...#.#.#.###...#...###...#.......#...#.#...#.#.#.....#...#...#.#.....#...#...#.#.#.#.................#.....#...#...###.#...#...#.#...#
#.###.#.###.#.#.###.#.#.#.#######.#######.#.#.###.#.#.###############.#####.#########.#.#.#.###############.#.###.#.#.#.#.###.#.###.#.#.###.#
#...#.#...#.#.#...#.#...#.#.....#.........#.#.#...#.#.....#...#...###.#.....###.......#.#...#...#...#...#...#.#...#.#.#.#...#.#.###.#.#.....#
###.#.###.#.#.###.#.#####.#.###.###########.#.#.###.#####.#.#.#.#.###.#.#######.#######.#####.#.#.#.#.#.#.###.#.###.#.#.###.#.#.###.#.#######
###.#.#...#...#...#.....#...#...###...#...#.#.#.###.#...#...#...#.#...#...#...#.......#...#...#...#...#.#...#.#.....#.#.#...#.#...#.#...#...#
###.#.#.#######.#######.#####.#####.#.#.#.#.#.#.###.#.#.#########.#.#####.#.#.#######.###.#.###########.###.#.#######.#.#.###.###.#.###.#.#.#
#...#...#.....#...#.....#...#...#...#...#.#.#.#...#.#.#.#...#.....#...#...#.#.###...#...#.#...........#.....#.#.......#.#...#.#...#.#...#.#.#
#.#######.###.###.#.#####.#.###.#.#######.#.#.###.#.#.#.#.#.#.#######.#.###.#.###.#.###.#.###########.#######.#.#######.###.#.#.###.#.###.#.#
#...#...#.###...#...#.....#...#.#.......#...#.....#...#.#.#...###.....#...#.#.#...#.....#.....#...#...#...###.#.........#...#...###.#.....#.#
###.#.#.#.#####.#####.#######.#.#######.###############.#.#######.#######.#.#.#.#############.#.#.#.###.#.###.###########.#########.#######.#
#...#.#.#...###.......#.......#.......#...###...#.....#...###...#.#.....#...#.#.......#.....#...#...#...#.....#.....#...#.#...###...#...#...#
#.###.#.###.###########.#############.###.###.#.#.###.#######.#.#.#.###.#####.#######.#.###.#########.#########.###.#.#.#.#.#.###.###.#.#.###
#...#.#.#...#...#.....#...#...#.....#.....#...#...#...#.......#.#...#...#...#.........#.###.#...#...#.#.........###.#.#.#...#.....#...#...###
###.#.#.#.###.#.#.###.###.#.#.#.###.#######.#######.###.#######.#####.###.#.###########.###.#.#.#.#.#.#.###########.#.#.###########.#########
#...#.#.#...#.#.#...#.....#.#...###.........#...#...#...#...#...#...#...#.#.#...#...#...#...#.#...#.#.#...........#...#.#.....#...#.....#...#
#.###.#.###.#.#.###.#######.#################.#.#.###.###.#.#.###.#.###.#.#.#.#.#.#.#.###.###.#####.#.###########.#####.#.###.#.#.#####.#.#.#
#...#.#...#.#.#...#.........#...###...........#...###.#...#...###.#...#...#...#.#.#...#...#...#.....#.#.......#...#...#...###...#.......#.#.#
###.#.###.#.#.###.###########.#.###.#################.#.#########.###.#########.#.#####.###.###.#####.#.#####.#.###.#.###################.#.#
###.#.#...#.#...#...#.........#...#.......#...........#.#...#...#.#...###...###...#.....#...#...#.....#.....#.#.....#...#...............#.#.#
###.#.#.###.###.###.#.###########.#######.#.###########.#.#.#.#.#.#.#####.#.#######.#####.###.###.#########.#.#########.#.#############.#.#.#
#...#.#.....###...#...#.....#...#.........#.#.....#...#.#.#.#.#.#.#...#...#.......#.....#...#.....#.........#.........#...#.....#...#...#.#.#
#.###.###########.#####.###.#.#.###########.#.###.#.#.#.#.#.#.#.#.###.#.#########.#####.###.#######.#################.#####.###.#.#.#.###.#.#
#...#.#...........#...#.###...#.............#...#...#...#.#.#.#.#.#...#.....#.....#...#.....###...#...............###...#...###...#...#...#.#
###.#.#.###########.#.#.#######################.#########.#.#.#.#.#.#######.#.#####.#.#########.#.###############.#####.#.#############.###.#
#...#.#.............#...#...#.........#.........#######...#...#.#.#...#...#.#.....#.#.#...###...#.................#...#...#.............#...#
#.###.###################.#.#.#######.#.###############.#######.#.###.#.#.#.#####.#.#.#.#.###.#####################.#.#####.#############.###
#.....#...................#...#.....#.#...###########...#.......#...#...#.#...#...#.#...#.#...#.....................#.......#.............###
#######.#######################.###.#.###.###########.###.#########.#####.###.#.###.#####.#.###.#############################.###############
###...#...........#.............#...#.....###########...#.#.......#.#.....###.#.###.....#.#.....#.......#...................#...........#...#
###.#.###########.#.#############.#####################.#.#.#####.#.#.#######.#.#######.#.#######.#####.#.#################.###########.#.#.#
#...#...........#.#.###...###...#.......#############...#.#.....#.#.#.#...#...#.#...#...#...#...#.....#...#...#...........#.#...#.......#.#.#
#.#############.#.#.###.#.###.#.#######.#############.###.#####.#.#.#.#.#.#.###.#.#.#.#####.#.#.#####.#####.#.#.#########.#.#.#.#.#######.#.#
#.....#.......#.#...#...#.....#.........#############...#.#...#.#.#.#.#.#.#...#.#.#.#...#...#.#.#...#.....#.#...#.....#...#.#.#.#.....#...#.#
#####.#.#####.#.#####.#################################.#.#.#.#.#.#.#.#.#.###.#.#.#.###.#.###.#.#.#.#####.#.#####.###.#.###.#.#.#####.#.###.#
#.....#.#.....#...#...#...#...#...#S#################...#.#.#.#.#.#.#...#.#...#.#.#...#.#...#.#.#.#.#...#...#.....#...#.###...#.#...#...#...#
#.#####.#.#######.#.###.#.#.#.#.#.#.#################.###.#.#.#.#.#.#####.#.###.#.###.#.###.#.#.#.#.#.#.#####.#####.###.#######.#.#.#####.###
#.......#.......#...#...#...#.#.#.#.#################...#.#.#.#.#.#...#...#...#.#...#.#.#...#.#.#.#.#.#.#...#...###...#...#...#...#.....#...#
###############.#####.#######.#.#.#.###################.#.#.#.#.#.###.#.#####.#.###.#.#.#.###.#.#.#.#.#.#.#.###.#####.###.#.#.#########.###.#
#.............#.....#.#.......#.#...#################...#...#.#.#...#.#...#...#...#.#...#...#.#.#.#.#.#.#.#...#.....#...#...#.........#.....#
#.###########.#####.#.#.#######.#####################.#######.#.###.#.###.#.#####.#.#######.#.#.#.#.#.#.#.###.#####.###.#############.#######
#...........#.......#.#.....#...#...#################...###...#.#...#...#.#.....#.#.###.....#.#.#.#...#.#...#.#...#...#...#.....#...#...#...#
###########.#########.#####.#.###.#.###################.###.###.#.#####.#.#####.#.#.###.#####.#.#.#####.###.#.#.#.###.###.#.###.#.#.###.#.#.#
#...........#...#...#.....#.#.....#.###################...#.#...#...#...#.#.....#.#...#.....#.#.#.#.....#...#.#.#...#...#.#...#...#...#...#.#
#.###########.#.#.#.#####.#.#######.#####################.#.#.#####.#.###.#.#####.###.#####.#.#.#.#.#####.###.#.###.###.#.###.#######.#####.#
#...#...#...#.#...#...#...#.#...#...###################...#.#...#...#.#...#...###...#.#.....#.#.#.#...#...#...#...#.#...#.....#.....#...#...#
###.#.#.#.#.#.#######.#.###.#.#.#.#####################.###.###.#.###.#.#####.#####.#.#.#####.#.#.###.#.###.#####.#.#.#########.###.###.#.###
###...#...#...###...#.#.###...#.#...#################...###.#...#...#.#.#...#...###.#.#.....#.#.#...#.#.###...#...#.#.........#.#...#...#...#
#################.#.#.#.#######.###.#################.#####.#.#####.#.#.#.#.###.###.#.#####.#.#.###.#.#.#####.#.###.#########.#.#.###.#####.#
#...............#.#...#.....###.#...#############E..#.....#...#.....#.#.#.#.#...#...#...#...#.#.#...#.#.....#.#...#...#.....#...#.###.......#
#.#############.#.#########.###.#.#################.#####.#####.#####.#.#.#.#.###.#####.#.###.#.#.###.#####.#.###.###.#.###.#####.###########
#.....#...#...#...#.....#...#...#...#...............#...#.....#.#...#.#.#.#...###...#...#...#.#.#.#...#...#.#...#...#.#...#.#...#...........#
#####.#.#.#.#.#####.###.#.###.#####.#.###############.#.#####.#.#.#.#.#.#.#########.#.#####.#.#.#.#.###.#.#.###.###.#.###.#.#.#.###########.#
#...#.#.#...#.....#...#.#...#...#...#.............#...#...#...#...#.#.#.#.#.........#.#...#...#...#.#...#...#...#...#.#...#...#.#...#...#...#
#.#.#.#.#########.###.#.###.###.#.###############.#.#####.#.#######.#.#.#.#.#########.#.#.#########.#.#######.###.###.#.#######.#.#.#.#.#.###
#.#...#.#.......#.#...#...#...#.#.###.............#.....#...#.....#.#.#.#.#.#...#...#...#...#...#...#.......#...#.#...#.#.....#.#.#.#.#.#...#
#.#####.#.#####.#.#.#####.###.#.#.###.#################.#####.###.#.#.#.#.#.#.#.#.#.#######.#.#.#.#########.###.#.#.###.#.###.#.#.#.#.#.###.#
#.#...#.#.....#...#.....#.#...#.#...#.............#...#.......#...#.#.#.#.#...#.#.#...#...#...#.#...........#...#.#...#...#...#...#...#.....#
#.#.#.#.#####.#########.#.#.###.###.#############.#.#.#########.###.#.#.#.#####.#.###.#.#.#####.#############.###.###.#####.#################
#.#.#.#.#.....#...#...#.#.#...#.#...#.............#.#.#.....#...###...#...#.....#.###...#.#...#.............#...#.#...#...#.............#...#
#.#.#.#.#.#####.#.#.#.#.#.###.#.#.###.#############.#.#.###.#.#############.#####.#######.#.#.#############.###.#.#.###.#.#############.#.#.#
#.#.#.#.#.....#.#.#.#.#.#.....#...###...........#...#.#.###.#...........###...#...#.......#.#...#...#.......###...#...#.#.#.............#.#.#
#.#.#.#.#####.#.#.#.#.#.#######################.#.###.#.###.###########.#####.#.###.#######.###.#.#.#.###############.#.#.#.#############.#.#
#...#.#...#...#.#.#.#...###.......#...#...#.....#...#.#...#.......#...#...###...###.#.....#.#...#.#.#.........#.......#.#.#.......#...#...#.#
#####.###.#.###.#.#.#######.#####.#.#.#.#.#.#######.#.###.#######.#.#.###.#########.#.###.#.#.###.#.#########.#.#######.#.#######.#.#.#.###.#
#.....#...#...#.#.#.......#.....#.#.#.#.#...#.....#.#...#.#...###...#.#...#.........#.###...#...#.#...#.......#.#.....#.#...#...#...#...#...#
#.#####.#####.#.#.#######.#####.#.#.#.#.#####.###.#.###.#.#.#.#######.#.###.#########.#########.#.###.#.#######.#.###.#.###.#.#.#########.###
#.#...#...#...#.#...#...#.#.....#...#...#...#.#...#.#...#...#.......#.#.#...#...#...#.#.........#.#...#.....#...#.#...#...#.#.#.#...#...#...#
#.#.#.###.#.###.###.#.#.#.#.#############.#.#.#.###.#.#############.#.#.#.###.#.#.#.#.#.#########.#.#######.#.###.#.#####.#.#.#.#.#.#.#.###.#
#...#.....#.....###...#...#...............#...#.....#...............#...#.....#...#...#...........#.........#.....#.......#...#...#...#.....#
#############################################################################################################################################"""

lines = lines.split("\n")

tiles = [[char for char in line.strip()] for line in lines]
grid = np.array(tiles)
start = np.argwhere(grid == "S")[0]
end = np.argwhere(grid == "E")[0]
min_saving = 100
max_cheat = 20
dirs = [[1, 0], [0, 1], [-1, 0], [0, -1]]


def get_distance_from_end():
    distance_from_end = []
    current = [end[0], end[1]]
    for dir in dirs:
        if grid[current[0] + dir[0], current[1] + dir[1]] == ".":
            last_dir = dir
            break
    while True:
        distance_from_end.append(current)
        trypos = [current[0] + last_dir[0], current[1] + last_dir[1]]
        if grid[trypos[0], trypos[1]] == "#":
            for trydir in [[last_dir[1], last_dir[0]], [-last_dir[1], -last_dir[0]]]:
                if grid[current[0] + trydir[0], current[1] + trydir[1]] != "#":
                    last_dir = trydir
                    current = [current[0] + trydir[0], current[1] + trydir[1]]
                    break
        else:
            current = trypos
        if grid[current[0], current[1]] == "S":
            distance_from_end.append(current)
            return distance_from_end


distance_from_end = get_distance_from_end()
count = 0
for idx, pos in tqdm(enumerate(distance_from_end)):
    if len(distance_from_end) - 1 - idx < min_saving:
        break
    for idx_2, pos_2 in enumerate(distance_from_end[(idx + min_saving) :]):
        distance = abs(pos[0] - pos_2[0]) + abs(pos[1] - pos_2[1])
        if distance <= max_cheat:
            saving = (
                distance_from_end.index([pos_2[0], pos_2[1]])
                - distance
                - distance_from_end.index([pos[0], pos[1]])
            )
            if saving >= min_saving:
                count += 1


print(count)
